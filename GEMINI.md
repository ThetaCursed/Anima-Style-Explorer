# Anima 2B Style Explorer: AI Context

This project is a high-performance visual database and artist style explorer optimized for the **Anima 2B** parameter model. It provides a benchmark for how the model interprets artist influences from the Danbooru dataset.

## üèóÔ∏è Project Architecture

The project consists of two main parts:
1.  **Frontend:** A lightweight, vanilla JavaScript static web application for browsing and searching styles.
2.  **Data Pipeline:** A Python-based AI ensemble that analyzes stylistic "DNA" and uniqueness scores to enrich the frontend database.

### Core Technologies
- **Frontend:** HTML5, CSS3 (Modern Flexbox/Grid), Vanilla JavaScript.
- **Storage:** IndexedDB (via browser) for managing favorites and star ratings.
- **AI Backend:** Python, PyTorch, CLIP (OpenAI), ResNet (Microsoft), Scikit-learn.
- **Data Format:** Images are optimized WebP; database is stored as a JS constant in `app/data.js`.

---

## üõ†Ô∏è Key Commands & Workflow

### Development Setup
1.  **Environment:** Python 3.x is required for data processing.
2.  **Dependencies:** Install via `pip install -r requirements.txt`.
3.  **Local Server:** No specific server required; can be run by opening `index.html` directly or using a simple static server (e.g., `npx serve .`).

### Data Analysis Pipeline
To refresh the stylistic uniqueness scores and rebuild the database:
- **Windows:** `.\run_analysis.ps1` or `.\run_analysis.bat`
- **Linux/macOS:** `./run_analysis.sh`

**Pipeline Steps:**
1.  `analyze_styles.py`: Uses CLIP and ResNet features to calculate a "Uniqueness" score for every image in `images/`.
2.  `merge_data.py`: Merges the AI analysis into `app/data.js` using `app/data.js.original` as the source of truth.

---

## üìÇ Directory Structure

- `app/`: Core application logic.
  - `app.js`: Main frontend logic (gallery rendering, favorites, filters).
  - `data.js`: The active database generated by the pipeline.
  - `data.js.original`: The "Pristine Base" containing artist metadata without AI scores.
  - `style.css`: Modern CSS with variable-based themes.
- `images/`: Hierarchical storage for WebP artist preview images (e.g., `images/1/100140.webp`).
- `analyze_styles.py`: AI-ensemble script for stylistic fingerprinting.
- `merge_data.py`: Utility to sync Python analysis with JS frontend.

---

## üé® Development Conventions

### Frontend
- **No Frameworks:** Stick to Vanilla JS for performance and zero-dependency portability.
- **CSS Variables:** Use CSS variables defined in `:root` for layout and theme control.
- **IndexedDB:** Use the `StyleGalleryDB` for persistent user data (favorites, ratings).
- **Responsive Design:** Mobile-first approach with grid-column adjustments based on viewport.

### Data Processing
- **Pristine Base Pattern:** Never modify `app/data.js` manually. Update `app/data.js.original` if you need to add artists, and then run the merge script.
- **WebP Only:** All new images must be in WebP format to maintain the project's performance targets (~200MB total size).

### Style DNA Calculation
- Uniqueness scores are based on a combination of:
  - **Texture Features:** ResNet hidden states (Gram matrices).
  - **Vibe/Semantic Features:** CLIP vision embeddings.
  - **Stylometry:** Laplacian edge variance.
- Final scores are normalized via Local Outlier Factor (LOF).
